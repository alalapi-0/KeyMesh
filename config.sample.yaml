node:
  id: "host-A"
  listen_port: 51888
  # 可选：指明绑定网卡或 0.0.0.0
  bind_host: "0.0.0.0"

security:
  ca_cert: "keys/ca.crt"
  cert: "keys/host-A.crt"
  key: "keys/host-A.key"
  # 对端证书指纹白名单（SHA-256）
  fingerprint_whitelist: []

peers:
  - id: "host-B"
    addr: "10.8.0.12:51888"       # 由你已有的中继/VPN 提供可达地址
    cert_fingerprint: "sha256:ABCD..."
    shares_access:
      - share: "common"   # 公共域
        mode: "rw"
      - share: "to-B"     # 针对 B 的私有域
        mode: "rw"
  - id: "host-C"
    addr: "10.8.0.13:51888"
    cert_fingerprint: "sha256:EFGH..."
    shares_access:
      - share: "common"
        mode: "ro"
      - share: "to-C"
        mode: "rw"

shares:
  - name: "common"
    path: "./data/common"
    delete_propagation: false
    ignore_file: ".keymeshignore"
  - name: "to-B"
    path: "./data/peers/B"
    delete_propagation: true
  - name: "to-C"
    path: "./data/peers/C"
    delete_propagation: true

indexing:
  small_threshold_mb: 16
  sample_mb: 4
  hash_policy: "auto"
  ignore_hidden: true
  max_workers: 4

transfer:
  chunk_size_mb: 4
  max_concurrent_per_peer: 2
  retry_backoff_sec: [1, 5, 15, 60]
  max_retries: 5
  rate_limit_mb_s: 0
  sessions_dir: "out/.sessions"
  audit_log_dir: "logs/transfers"

logging:
  level: "info"
  file: "logs/keymesh.log"

connectivity:
  heartbeat_sec: 20
  connect_timeout_ms: 5000
  backoff: [1, 3, 10, 30]

status_http:
  enabled: true
  host: "127.0.0.1"
  port: 52180
